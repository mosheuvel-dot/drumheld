<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="apple-mobile-web-app-title" content="DrumHeld Jr."/>
  <title>ğŸ¥ DrumHeld Jr.</title>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet"/>
  <style>
    *{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
    html,body{height:100%;font-family:'Nunito',sans-serif;background:#1a1a2e;color:#fff;overflow-x:hidden;}
    button{font-family:'Nunito',sans-serif;cursor:pointer;border:none;outline:none;}
    button:active{opacity:0.8;}
    .fredoka{font-family:'Fredoka One',sans-serif;}
    #app{min-height:100vh;padding-bottom:80px;}

    /* Header */
    #header{background:#ffffff08;backdrop-filter:blur(14px);-webkit-backdrop-filter:blur(14px);border-bottom:1px solid #ffffff15;padding:12px 16px 10px;position:sticky;top:0;z-index:100;}
    #header-inner{max-width:480px;margin:0 auto;display:flex;align-items:center;gap:10px;}
    #title-row{display:flex;align-items:center;gap:8px;margin-bottom:5px;}
    #xp-bar-wrap{display:flex;align-items:center;gap:8px;flex:1;}
    #xp-track{flex:1;background:#ffffff22;border-radius:100px;height:10px;overflow:hidden;}
    #xp-fill{height:100%;background:linear-gradient(90deg,#FF6B6B,#FFB347);border-radius:100px;width:0%;transition:width 0.6s ease;}
    .lvl-badge{background:#FF6B6B;color:#fff;border-radius:20px;padding:2px 8px;font-size:11px;font-weight:900;}
    .xp-label{font-size:11px;color:#ffffff55;min-width:40px;text-align:right;}
    .lvl-label{font-weight:900;font-size:13px;color:#FF6B6B;min-width:50px;}

    /* Nav */
    #nav{position:fixed;bottom:0;left:0;right:0;background:#0a0a1aee;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-top:1px solid #ffffff15;display:flex;justify-content:space-around;padding:8px 0 16px;z-index:200;}
    .nav-btn{background:none;border:none;display:flex;flex-direction:column;align-items:center;gap:3px;padding:4px 10px;opacity:0.38;transition:opacity 0.2s;}
    .nav-btn.active{opacity:1;}
    .nav-emoji{font-size:22px;}
    .nav-label{font-size:10px;font-weight:800;color:#fff;}
    .nav-dot{width:18px;height:3px;background:#FF6B6B;border-radius:100px;display:none;}
    .nav-btn.active .nav-dot{display:block;}

    /* Screens */
    .screen{display:none;max-width:480px;margin:0 auto;padding:16px;}
    .screen.active{display:block;}

    /* Cards */
    .card{background:#ffffff0e;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:20px;padding:20px;border:1px solid #ffffff18;margin-bottom:14px;}
    .card-white{background:#fff;border-radius:20px;padding:20px;margin-bottom:14px;box-shadow:0 4px 24px #0002;}

    /* Hero */
    #hero{background:linear-gradient(135deg,#FF6B6B,#FFB347);border-radius:22px;padding:24px;margin-bottom:16px;text-align:center;box-shadow:0 8px 32px #FF6B6B44;}
    #hero-emoji{font-size:64px;margin-bottom:8px;}
    #hero-title{font-size:28px;margin-bottom:6px;}
    #hero-sub{font-size:14px;opacity:0.9;}

    /* Grid menu */
    .menu-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;}
    .menu-btn{background:#ffffff0c;border:2.5px solid transparent;border-radius:18px;padding:18px 12px;text-align:center;box-shadow:0 4px 20px #0001;transition:transform 0.1s;}
    .menu-btn:active{transform:scale(0.96);}
    .menu-btn-emoji{font-size:34px;margin-bottom:6px;}
    .menu-btn-title{font-size:15px;color:#fff;}
    .menu-btn-sub{font-size:11px;color:#888;margin-top:2px;}

    /* Tip */
    #tip-card{background:#ffffff0c;border-radius:16px;padding:16px;border:1.5px solid #ffffff15;}
    .tip-label{font-weight:900;color:#FFB347;font-size:13px;margin-bottom:6px;letter-spacing:1px;}

    /* Drum Pads */
    .pads-wrap{display:flex;flex-wrap:wrap;gap:14px;justify-content:center;margin-bottom:16px;}
    .pad{border-radius:50%;border:4px solid transparent;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;transition:all 0.07s ease;touch-action:manipulation;user-select:none;-webkit-user-select:none;}
    .pad:active,.pad.hit{transform:scale(0.93) translateY(4px)!important;}
    .pad-emoji{pointer-events:none;}
    .pad-name{font-size:11px;font-weight:700;pointer-events:none;}
    .pad-key{font-size:9px;border-radius:5px;padding:1px 5px;font-weight:800;pointer-events:none;}

    /* Log */
    #log-wrap{background:#ffffff0e;border-radius:14px;padding:14px;border:1px solid #ffffff18;}
    .log-label{font-size:11px;color:#ffffff44;font-weight:700;letter-spacing:1px;margin-bottom:8px;}
    #log-items{display:flex;flex-wrap:wrap;gap:5px;}
    .log-item{border-radius:8px;padding:3px 8px;font-size:18px;border:2px solid transparent;}

    /* Ritme spel */
    .level-tabs{display:flex;gap:6px;margin-bottom:14px;flex-wrap:wrap;}
    .level-tab{padding:5px 12px;border-radius:20px;font-weight:800;font-size:12px;background:#ffffff15;color:#aaa;transition:all 0.2s;}
    .level-tab.active{background:#FF6B6B;color:#fff;}
    .patroon-wrap{display:flex;gap:6px;flex-wrap:wrap;margin:12px 0;}
    .patroon-cel{width:42px;height:42px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:19px;transition:all 0.1s;border:2.5px solid transparent;}
    .patroon-cel.demo{transform:scale(1.18);}
    .patroon-label{font-size:12px;color:#ffffff33;font-family:monospace;letter-spacing:2px;margin-bottom:14px;}
    .speel-btn{width:100%;padding:13px;border-radius:12px;background:linear-gradient(135deg,#FF6B6B,#FFB347);color:#fff;font-weight:900;font-size:16px;font-family:'Fredoka One',sans-serif;}
    .status-box{border-radius:10px;padding:10px 14px;font-weight:800;text-align:center;font-size:15px;}
    .status-listen{background:#ffffff08;color:#ffffff55;font-style:italic;padding:10px 0;}
    .status-play{background:#6BCB7722;color:#6BCB77;border:1px solid #6BCB7744;}
    .resultaat-box{border-radius:12px;padding:14px 16px;text-align:center;}
    .resultaat-emoji{font-size:36px;margin-bottom:4px;}
    .resultaat-score{font-weight:900;font-size:20px;font-family:'Fredoka One',sans-serif;}
    .resultaat-btns{display:flex;gap:8px;justify-content:center;margin-top:12px;}
    .btn-secondary{padding:8px 16px;border-radius:10px;background:#ffffff15;color:#fff;font-weight:800;font-size:13px;}
    .btn-primary{padding:8px 16px;border-radius:10px;background:#FF6B6B;color:#fff;font-weight:800;font-size:13px;}
    .btn-green{padding:13px;border-radius:12px;background:#4ECDC4;color:#fff;font-weight:900;font-size:15px;width:100%;font-family:'Fredoka One',sans-serif;margin-top:10px;}
    .btn-red{padding:13px;border-radius:12px;background:#FF6B6B;color:#fff;font-weight:900;font-size:15px;width:100%;font-family:'Fredoka One',sans-serif;margin-top:10px;}

    /* Noten */
    .les-tabs{display:flex;gap:6px;margin-bottom:14px;}
    .les-tab{flex:1;padding:6px 4px;border-radius:10px;font-weight:900;font-size:13px;background:#ffffff15;color:#888;}
    .les-tab.geleerd{background:#4ECDC4;color:#fff;}
    .les-tab.actief{background:#45B7D1;color:#fff;}
    .les-uitleg{color:#ccc;font-size:15px;line-height:1.6;margin-bottom:14px;}
    .noten-grid{background:#ffffff08;border-radius:14px;padding:16px;margin-bottom:14px;border:1.5px dashed #ffffff22;}
    .noten-label{font-size:11px;color:#ffffff44;margin-bottom:10px;font-weight:700;letter-spacing:1px;}
    .noten-row{display:flex;gap:8px;align-items:center;}
    .noot-cel{flex:1;display:flex;flex-direction:column;align-items:center;gap:6px;}
    .noot-blok{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:900;}
    .noot-num{font-size:12px;color:#ffffff44;font-weight:800;}
    .tip-oefening{background:#FFB34718;border-radius:12px;padding:12px 14px;margin-bottom:14px;border:1px solid #FFB34733;}
    .tip-oef-label{font-size:11px;color:#FFB347;font-weight:900;margin-bottom:4px;letter-spacing:1px;}
    .tip-oef-tekst{color:#ffe4b3;font-size:14px;}
    .geluid-label{font-size:11px;color:#ffffff44;font-weight:700;letter-spacing:1px;margin-bottom:8px;}
    .btn-voltooi{width:100%;padding:13px;border-radius:12px;font-weight:900;font-size:15px;font-family:'Fredoka One',sans-serif;color:#fff;}

    /* Badges */
    .badges-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
    .badge-card{border-radius:14px;padding:14px;border:1.5px solid #ffffff15;background:#ffffff08;opacity:0.45;transition:all 0.3s;}
    .badge-card.verdiend{background:linear-gradient(135deg,#FF6B6B,#FFB347);border-color:#FF6B6B66;opacity:1;box-shadow:0 4px 20px #FF6B6B44;}
    .badge-emoji{font-size:32px;margin-bottom:4px;}
    .badge-naam{font-weight:900;font-size:13px;color:#888;}
    .badge-card.verdiend .badge-naam{color:#fff;}
    .badge-eis{font-size:11px;color:#666;margin-top:2px;}
    .badge-card.verdiend .badge-eis{color:#fff9;}

    /* Confetti */
    #confetti{position:fixed;inset:0;pointer-events:none;z-index:9999;overflow:hidden;display:none;}
    .confetti-piece{position:absolute;top:-10px;opacity:0;}
    @keyframes fall{0%{transform:translateY(0) rotate(0deg);opacity:1;}100%{transform:translateY(110vh) rotate(720deg);opacity:0;}}

    /* Print */
    @media print{
      #header,#nav,.screen:not(#screen-print){display:none!important;}
      #screen-print{display:block!important;background:#fff;color:#000;padding:20px;}
    }
  </style>
</head>
<body>
<div id="app">
  <!-- Confetti -->
  <div id="confetti"></div>

  <!-- Header -->
  <div id="header">
    <div id="header-inner">
      <div style="flex:1">
        <div id="title-row">
          <span style="font-size:24px">ğŸ¥</span>
          <span class="fredoka" style="font-size:22px;color:#fff">DrumHeld Jr.</span>
          <span class="lvl-badge" id="lvl-badge">LVL 1</span>
        </div>
        <div id="xp-bar-wrap">
          <span class="lvl-label" id="lvl-label">Lvl 1</span>
          <div id="xp-track"><div id="xp-fill"></div></div>
          <span class="xp-label" id="xp-label">0/100</span>
        </div>
      </div>
      <button onclick="openPrint()" style="background:#ffffff12;border:1.5px solid #ffffff25;border-radius:10px;padding:7px 11px;font-size:18px;color:#fff;">ğŸ–¨ï¸</button>
    </div>
  </div>

  <!-- Screens -->
  <div id="screen-home" class="screen active">
    <div id="hero">
      <div id="hero-emoji">ğŸ¥</div>
      <div class="fredoka" id="hero-title">Hey Drummer!</div>
      <div id="hero-sub">Je hebt al <strong id="hero-xp">0</strong> XP verdiend en <strong id="hero-badges">0</strong> badges!</div>
    </div>
    <div class="menu-grid">
      <button class="menu-btn" style="border-color:#FF6B6B55;box-shadow:0 4px 20px #FF6B6B18;" onclick="gaNaar('vrij')">
        <div class="menu-btn-emoji">ğŸ¥</div>
        <div class="fredoka menu-btn-title">Vrij Spelen</div>
        <div class="menu-btn-sub">Doe maar raak!</div>
      </button>
      <button class="menu-btn" style="border-color:#FFB34755;box-shadow:0 4px 20px #FFB34718;" onclick="gaNaar('ritme')">
        <div class="menu-btn-emoji">ğŸ®</div>
        <div class="fredoka menu-btn-title">Ritme Spel</div>
        <div class="menu-btn-sub">Hoor &amp; speel na</div>
      </button>
      <button class="menu-btn" style="border-color:#4ECDC455;box-shadow:0 4px 20px #4ECDC418;" onclick="gaNaar('noten')">
        <div class="menu-btn-emoji">ğŸµ</div>
        <div class="fredoka menu-btn-title">Noten Leren</div>
        <div class="menu-btn-sub">Wat zijn de tekens?</div>
      </button>
      <button class="menu-btn" style="border-color:#C77DFF55;box-shadow:0 4px 20px #C77DFF18;" onclick="gaNaar('badges')">
        <div class="menu-btn-emoji">ğŸ†</div>
        <div class="fredoka menu-btn-title">Badges</div>
        <div class="menu-btn-sub" id="badges-sub">0/5 verdiend</div>
      </button>
    </div>
    <div id="tip-card">
      <div class="tip-label">ğŸ’¡ TIP VAN VANDAAG</div>
      <div id="tip-tekst" style="color:#ccc;font-size:14px;line-height:1.5;"></div>
    </div>
  </div>

  <div id="screen-vrij" class="screen">
    <div class="card" style="text-align:center;">
      <p style="margin:0;color:#aaa;font-size:13px;">Toetsenbord: <strong style="color:#fff">1 2 3 4</strong> en <strong style="color:#fff">spatie</strong> voor kick</p>
    </div>
    <div class="pads-wrap" id="vrij-pads"></div>
    <div id="log-wrap" style="display:none;">
      <div class="log-label">JOUW RITME:</div>
      <div id="log-items"></div>
    </div>
  </div>

  <div id="screen-ritme" class="screen">
    <div class="level-tabs" id="level-tabs"></div>
    <div class="card">
      <h3 class="fredoka" id="ritme-titel" style="font-size:20px;margin-bottom:6px;"></h3>
      <div class="patroon-wrap" id="patroon-wrap"></div>
      <div class="patroon-label" id="patroon-label"></div>
      <div id="ritme-actie"></div>
    </div>
    <div class="pads-wrap" id="ritme-pads" style="display:none;"></div>
  </div>

  <div id="screen-noten" class="screen">
    <div class="les-tabs" id="les-tabs"></div>
    <div class="card" id="les-kaart"></div>
  </div>

  <div id="screen-badges" class="screen">
    <div class="card">
      <h3 class="fredoka" style="font-size:20px;margin-bottom:14px;">ğŸ† Jouw Badges</h3>
      <div class="badges-grid" id="badges-grid"></div>
    </div>
  </div>

  <!-- Nav -->
  <div id="nav">
    <button class="nav-btn active" id="nav-home" onclick="gaNaar('home')">
      <span class="nav-emoji">ğŸ </span><span class="nav-label">Home</span><div class="nav-dot"></div>
    </button>
    <button class="nav-btn" id="nav-vrij" onclick="gaNaar('vrij')">
      <span class="nav-emoji">ğŸ¥</span><span class="nav-label">Spelen</span><div class="nav-dot"></div>
    </button>
    <button class="nav-btn" id="nav-ritme" onclick="gaNaar('ritme')">
      <span class="nav-emoji">ğŸ®</span><span class="nav-label">Spel</span><div class="nav-dot"></div>
    </button>
    <button class="nav-btn" id="nav-noten" onclick="gaNaar('noten')">
      <span class="nav-emoji">ğŸµ</span><span class="nav-label">Noten</span><div class="nav-dot"></div>
    </button>
    <button class="nav-btn" id="nav-badges" onclick="gaNaar('badges')">
      <span class="nav-emoji">ğŸ†</span><span class="nav-label">Badges</span><div class="nav-dot"></div>
    </button>
  </div>
</div>

<script>
// â”€â”€ Audio â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let audioCtx = null;

function initAudio() {
  if (audioCtx) return;
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
}

function resumeAudio() {
  if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
}

function playDrum(type) {
  initAudio();
  resumeAudio();
  const ctx = audioCtx;
  const t = ctx.currentTime;
  const out = ctx.createGain();
  out.connect(ctx.destination);

  if (type === 'kick') {
    const o = ctx.createOscillator(), g = ctx.createGain();
    o.connect(g); g.connect(out);
    o.frequency.setValueAtTime(120, t);
    o.frequency.exponentialRampToValueAtTime(0.001, t + 0.55);
    g.gain.setValueAtTime(1.2, t);
    g.gain.exponentialRampToValueAtTime(0.001, t + 0.55);
    o.start(t); o.stop(t + 0.55);
  } else if (type === 'snare') {
    const buf = ctx.createBuffer(1, ctx.sampleRate * 0.22, ctx.sampleRate);
    const d = buf.getChannelData(0);
    for (let i = 0; i < d.length; i++) d[i] = Math.random() * 2 - 1;
    const s = ctx.createBufferSource(), g = ctx.createGain(), f = ctx.createBiquadFilter();
    f.type = 'bandpass'; f.frequency.value = 2500; f.Q.value = 0.8;
    s.buffer = buf; s.connect(f); f.connect(g); g.connect(out);
    g.gain.setValueAtTime(0.9, t); g.gain.exponentialRampToValueAtTime(0.001, t + 0.22);
    s.start(t); s.stop(t + 0.22);
  } else if (type === 'hihat') {
    const buf = ctx.createBuffer(1, ctx.sampleRate * 0.08, ctx.sampleRate);
    const d = buf.getChannelData(0);
    for (let i = 0; i < d.length; i++) d[i] = Math.random() * 2 - 1;
    const s = ctx.createBufferSource(), g = ctx.createGain(), f = ctx.createBiquadFilter();
    f.type = 'highpass'; f.frequency.value = 9000;
    s.buffer = buf; s.connect(f); f.connect(g); g.connect(out);
    g.gain.setValueAtTime(0.55, t); g.gain.exponentialRampToValueAtTime(0.001, t + 0.08);
    s.start(t); s.stop(t + 0.08);
  } else if (type === 'tom') {
    const o = ctx.createOscillator(), g = ctx.createGain();
    o.connect(g); g.connect(out);
    o.frequency.setValueAtTime(185, t);
    o.frequency.exponentialRampToValueAtTime(55, t + 0.35);
    g.gain.setValueAtTime(0.9, t); g.gain.exponentialRampToValueAtTime(0.001, t + 0.35);
    o.start(t); o.stop(t + 0.35);
  } else if (type === 'crash') {
    const buf = ctx.createBuffer(1, ctx.sampleRate * 0.7, ctx.sampleRate);
    const d = buf.getChannelData(0);
    for (let i = 0; i < d.length; i++) d[i] = Math.random() * 2 - 1;
    const s = ctx.createBufferSource(), g = ctx.createGain(), f = ctx.createBiquadFilter();
    f.type = 'bandpass'; f.frequency.value = 5000; f.Q.value = 0.4;
    s.buffer = buf; s.connect(f); f.connect(g); g.connect(out);
    g.gain.setValueAtTime(0.5, t); g.gain.exponentialRampToValueAtTime(0.001, t + 0.7);
    s.start(t); s.stop(t + 0.7);
  }
}

// Init audio on first touch anywhere
document.addEventListener('touchstart', () => { initAudio(); resumeAudio(); }, { once: false, passive: true });
document.addEventListener('pointerdown', () => { initAudio(); resumeAudio(); }, { once: false, passive: true });

// â”€â”€ Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DRUMS = [
  { id:'crash', emoji:'ğŸ’¥', naam:'Crash',  kleur:'#FF6B6B', bg:'#FFE8E8', key:'1' },
  { id:'hihat', emoji:'ğŸ©', naam:'Hi-Hat', kleur:'#FFB347', bg:'#FFF3E0', key:'2' },
  { id:'tom',   emoji:'ğŸŸ ', naam:'Tom',    kleur:'#4ECDC4', bg:'#E0F7F6', key:'3' },
  { id:'snare', emoji:'âš¡', naam:'Snare',  kleur:'#45B7D1', bg:'#E0F4FB', key:'4' },
  { id:'kick',  emoji:'ğŸ’£', naam:'Kick',   kleur:'#96CEB4', bg:'#E8F5EE', key:'sp' },
];

const XP_PER_LEVEL = 100;

const BADGES = [
  { id:'eerste_slag',  naam:'Eerste Slag! ğŸ¥',  eis:'Speel je eerste noot',    emoji:'ğŸ¥' },
  { id:'ritme_held',   naam:'Ritme Held ğŸ¦¸',     eis:'Voltooi 3 spellen',       emoji:'ğŸ¦¸' },
  { id:'noot_meester', naam:'Noot Meester ğŸµ',   eis:'Leer 5 noten kennen',     emoji:'ğŸµ' },
  { id:'perfectie',    naam:'Perfect! â­',        eis:'100% score op een spel',  emoji:'â­' },
  { id:'dagelijkse',   naam:'Dagelijkse Held ğŸŒŸ', eis:'7 dagen geoefend',        emoji:'ğŸŒŸ' },
];

const LEVELS = [
  { id:1, naam:'Level 1 â€“ EÃ©n slag',     bpm:55, patroon:['kick','kick','kick','kick'],                                            label:'K  K  K  K' },
  { id:2, naam:'Level 2 â€“ Twee drums',   bpm:60, patroon:['kick','snare','kick','snare'],                                          label:'K  S  K  S' },
  { id:3, naam:'Level 3 â€“ Hi-Hat erbij', bpm:65, patroon:['hihat','hihat','snare','hihat','hihat','snare','kick','kick'],          label:'H H S H H S K K' },
  { id:4, naam:'Level 4 â€“ Rock ritme',   bpm:70, patroon:['kick','hihat','snare','hihat','kick','hihat','snare','hihat'],          label:'K H S H K H S H' },
  { id:5, naam:'Level 5 â€“ Superster',    bpm:80, patroon:['crash','kick','hihat','snare','tom','kick','hihat','crash'],            label:'C K H S T K H C' },
];

const LESSEN = [
  { id:1, titel:'Wat is een maat? ğŸ“', uitleg:'Een maat is een groepje slagen. We tellen: 1-2-3-4. Net als bij klappen!',         oefening:'Klap 4x mee: 1 âœ‹ 2 âœ‹ 3 âœ‹ 4 âœ‹',                               symbolen:['1','2','3','4'],       kleuren:['#FF6B6B','#FFB347','#4ECDC4','#45B7D1'], drum:null },
  { id:2, titel:'De Kick Noot ğŸ’£',     uitleg:'De kick-drum zit onderaan. We tekenen hem als een gevulde noot.',                  oefening:'Stamp met voet op slag 1 en 3: BOEM-rust-BOEM-rust',          symbolen:['ğŸ’£','â€”','ğŸ’£','â€”'],     kleuren:['#96CEB4','#ddd','#96CEB4','#ddd'],       drum:'kick' },
  { id:3, titel:'De Snare Noot âš¡',    uitleg:"De snare zit in het midden. Op slag 2 en 4: dat is de 'backbeat'!",               oefening:'Klap op knie op slag 2 en 4: rust-PAK-rust-PAK',             symbolen:['â€”','âš¡','â€”','âš¡'],     kleuren:['#ddd','#45B7D1','#ddd','#45B7D1'],       drum:'snare' },
  { id:4, titel:'De Hi-Hat ğŸ©',        uitleg:'De hi-hat klinkt op elke tel! Het is een kruis-teken boven de lijn.',             oefening:'Tik met vinger op tafel op elke tel: tss tss tss tss',        symbolen:['ğŸ©','ğŸ©','ğŸ©','ğŸ©'],   kleuren:['#FFB347','#FFB347','#FFB347','#FFB347'], drum:'hihat' },
  { id:5, titel:'Alles samen! ğŸ¶',     uitleg:'Kick, snare en hi-hat samen: het basisritme van bijna alle liedjes!',             oefening:'Voet-tik-knie-tik: BOEM-tss-PAK-tss-BOEM-tss-PAK-tss',      symbolen:['ğŸ’£ğŸ©','ğŸ©','âš¡ğŸ©','ğŸ©'], kleuren:['#96CEB4','#FFB347','#45B7D1','#FFB347'], drum:null },
];

const TIPS = [
  'Stamp 4x met je voet mee op je favoriete liedje!',
  'Tik het ritme op je knie: BOEM-tss-PAK-tss',
  'Tel hardop mee: 1-2-3-4 terwijl je muziek luistert',
  'Klap op slag 2 en 4 van elk nummer dat je hoort',
  'Oefen de hi-hat door snel op tafel te tikken',
  'Bedenk je eigen ritme en speel het 5x',
  'Luister naar een liedje en zoek de kick-drum',
];

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let state = {
  xp: 0,
  badges: [],
  notenGeleerd: [],
  spellenVoltooid: 0,
  eersteKeer: true,
  huidigScherm: 'home',
  // ritme spel
  ritmeLevelIdx: 0,
  ritmeFase: 'intro', // intro | demo | spelen | resultaat
  ritmeInput: [],
  ritmeScore: null,
  ritmeDemoStap: -1,
  ritmeActief: null,
  // noten
  lesIdx: 0,
  lesKlaar: false,
  lesActief: null,
  // vrij spelen
  vrijActief: null,
  log: [],
};

let ritmeTimer = null;

// â”€â”€ localStorage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function laad() {
  try { const v = localStorage.getItem('drum-xp');      if (v) state.xp = +v; } catch {}
  try { const v = localStorage.getItem('drum-badges');  if (v) state.badges = JSON.parse(v); } catch {}
  try { const v = localStorage.getItem('drum-noten');   if (v) state.notenGeleerd = JSON.parse(v); } catch {}
  try { const v = localStorage.getItem('drum-spellen'); if (v) state.spellenVoltooid = +v; } catch {}
  try { const v = localStorage.getItem('drum-eerste');  if (v) state.eersteKeer = false; } catch {}
}

function slaOp(key, val) { try { localStorage.setItem(key, val); } catch {} }

// â”€â”€ XP & Badges â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function voegXPToe(amount) {
  const oud = Math.floor(state.xp / XP_PER_LEVEL);
  state.xp += amount;
  slaOp('drum-xp', state.xp);
  if (Math.floor(state.xp / XP_PER_LEVEL) > oud) schietConfetti();
  updateHeader();
  updateHero();
}

function verdienBadge(id) {
  if (state.badges.includes(id)) return;
  state.badges.push(id);
  slaOp('drum-badges', JSON.stringify(state.badges));
  schietConfetti();
  updateHero();
  updateBadgesSub();
}

// â”€â”€ Confetti â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function schietConfetti() {
  const wrap = document.getElementById('confetti');
  wrap.innerHTML = '';
  wrap.style.display = 'block';
  const kleuren = ['#FF6B6B','#FFB347','#4ECDC4','#45B7D1','#96CEB4','#FFD93D'];
  for (let i = 0; i < 40; i++) {
    const el = document.createElement('div');
    el.className = 'confetti-piece';
    el.style.left = Math.random() * 100 + '%';
    el.style.width = (8 + Math.random() * 10) + 'px';
    el.style.height = el.style.width;
    el.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    el.style.background = kleuren[i % kleuren.length];
    const dur = 1.5 + Math.random();
    const delay = Math.random() * 0.8;
    el.style.animation = `fall ${dur}s ${delay}s ease-in forwards`;
    wrap.appendChild(el);
  }
  setTimeout(() => { wrap.style.display = 'none'; wrap.innerHTML = ''; }, 3500);
}

// â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateHeader() {
  const level = Math.floor(state.xp / XP_PER_LEVEL) + 1;
  const pct = (state.xp % XP_PER_LEVEL) / XP_PER_LEVEL * 100;
  document.getElementById('lvl-badge').textContent = 'LVL ' + level;
  document.getElementById('lvl-label').textContent = 'Lvl ' + level;
  document.getElementById('xp-fill').style.width = pct + '%';
  document.getElementById('xp-label').textContent = (state.xp % XP_PER_LEVEL) + '/100';
}

function updateHero() {
  const el1 = document.getElementById('hero-xp');
  const el2 = document.getElementById('hero-badges');
  if (el1) el1.textContent = state.xp;
  if (el2) el2.textContent = state.badges.length;
}

function updateBadgesSub() {
  const el = document.getElementById('badges-sub');
  if (el) el.textContent = state.badges.length + '/5 verdiend';
}

// â”€â”€ Navigatie â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function gaNaar(scherm) {
  initAudio(); resumeAudio();
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('screen-' + scherm).classList.add('active');
  document.getElementById('nav-' + scherm).classList.add('active');
  state.huidigScherm = scherm;
  if (scherm === 'vrij')   renderVrij();
  if (scherm === 'ritme')  renderRitme();
  if (scherm === 'noten')  renderNoten();
  if (scherm === 'badges') renderBadges();
  if (scherm === 'home')   { updateHero(); updateBadgesSub(); }
}

// â”€â”€ Pad component â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function maakPad(drum, size, onHit) {
  const btn = document.createElement('button');
  btn.className = 'pad';
  btn.id = 'pad-' + drum.id + '-' + Math.random().toString(36).substr(2,5);
  btn.style.width = size + 'px';
  btn.style.height = size + 'px';
  btn.style.background = drum.bg;
  btn.style.borderColor = drum.kleur;
  btn.style.boxShadow = `0 5px 0 ${drum.kleur}55, inset 0 2px 0 #fff6`;

  btn.innerHTML = `
    <span class="pad-emoji" style="font-size:${size>80?28:22}px">${drum.emoji}</span>
    <span class="pad-name" style="color:#555">${drum.naam}</span>
    <span class="pad-key" style="background:${drum.kleur}22;color:${drum.kleur}">${drum.key}</span>
  `;

  function activeer() {
    initAudio(); resumeAudio();
    btn.style.background = drum.kleur;
    btn.style.transform = 'scale(0.93) translateY(4px)';
    btn.style.boxShadow = `0 0 28px ${drum.kleur}bb, inset 0 2px 0 #fff4`;
    btn.querySelector('.pad-name').style.color = '#fff';
    setTimeout(() => {
      btn.style.background = drum.bg;
      btn.style.transform = '';
      btn.style.boxShadow = `0 5px 0 ${drum.kleur}55, inset 0 2px 0 #fff6`;
      btn.querySelector('.pad-name').style.color = '#555';
    }, 120);
    onHit(drum.id);
  }

  btn.addEventListener('pointerdown', e => { e.preventDefault(); activeer(); });
  return btn;
}

function activeerPadVisueel(containerId, drumId) {
  const wrap = document.getElementById(containerId);
  if (!wrap) return;
  wrap.querySelectorAll('.pad').forEach(btn => {
    if (btn.dataset.drumid === drumId) {
      btn.style.background = DRUMS.find(d=>d.id===drumId).kleur;
      btn.style.transform = 'scale(0.93) translateY(4px)';
      setTimeout(() => {
        const d = DRUMS.find(x=>x.id===drumId);
        btn.style.background = d.bg;
        btn.style.transform = '';
      }, 120);
    }
  });
}

// â”€â”€ Vrij Spelen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderVrij() {
  const wrap = document.getElementById('vrij-pads');
  wrap.innerHTML = '';
  DRUMS.forEach(drum => {
    const pad = maakPad(drum, 100, (id) => vrijSlagHit(id));
    pad.dataset.drumid = drum.id;
    wrap.appendChild(pad);
  });
}

function vrijSlagHit(id) {
  playDrum(id);
  // log
  state.log.unshift(id);
  if (state.log.length > 14) state.log.pop();
  renderLog();
  // eerste keer badge
  if (state.eersteKeer) {
    state.eersteKeer = false;
    slaOp('drum-eerste', 'done');
    voegXPToe(10);
    verdienBadge('eerste_slag');
  }
}

function renderLog() {
  const wrap = document.getElementById('log-wrap');
  const items = document.getElementById('log-items');
  if (state.log.length === 0) { wrap.style.display = 'none'; return; }
  wrap.style.display = 'block';
  items.innerHTML = '';
  state.log.forEach((id, i) => {
    const d = DRUMS.find(x => x.id === id);
    const span = document.createElement('span');
    span.className = 'log-item';
    span.style.background = d.bg;
    span.style.borderColor = d.kleur;
    span.style.opacity = 1 - i * 0.06;
    span.textContent = d.emoji;
    items.appendChild(span);
  });
}

// Keyboard
document.addEventListener('keydown', e => {
  const map = {'1':'crash','2':'hihat','3':'tom','4':'snare',' ':'kick'};
  if (!map[e.key]) return;
  e.preventDefault();
  initAudio(); resumeAudio();
  const id = map[e.key];
  if (state.huidigScherm === 'vrij') vrijSlagHit(id);
  else if (state.huidigScherm === 'ritme') ritmeSlagHit(id);
});

// â”€â”€ Ritme Spel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderRitme() {
  renderLevelTabs();
  renderRitmeKaart();
}

function renderLevelTabs() {
  const wrap = document.getElementById('level-tabs');
  wrap.innerHTML = '';
  LEVELS.forEach((l, i) => {
    const btn = document.createElement('button');
    btn.className = 'level-tab' + (i === state.ritmeLevelIdx ? ' active' : '');
    btn.textContent = 'Lvl ' + l.id;
    btn.addEventListener('pointerdown', () => {
      clearInterval(ritmeTimer);
      state.ritmeLevelIdx = i;
      state.ritmeFase = 'intro';
      state.ritmeScore = null;
      state.ritmeInput = [];
      renderRitme();
    });
    wrap.appendChild(btn);
  });
}

function renderRitmeKaart() {
  const lv = LEVELS[state.ritmeLevelIdx];
  document.getElementById('ritme-titel').textContent = 'ğŸ® ' + lv.naam;
  document.getElementById('patroon-label').textContent = lv.label;

  // Patroon cellen
  const wrap = document.getElementById('patroon-wrap');
  wrap.innerHTML = '';
  lv.patroon.forEach((id, i) => {
    const d = DRUMS.find(x => x.id === id);
    const cel = document.createElement('div');
    cel.className = 'patroon-cel';
    cel.id = 'pc-' + i;
    cel.style.background = d.bg;
    cel.style.borderColor = d.kleur;
    cel.style.opacity = state.ritmeFase === 'intro' ? '0.65' : '1';
    if (state.ritmeScore) {
      cel.style.background = (state.ritmeInput[i] === id) ? '#6BCB77' : '#FF6B6B';
    }
    cel.textContent = d.emoji;
    wrap.appendChild(cel);
  });

  // Actie gebied
  const actie = document.getElementById('ritme-actie');
  actie.innerHTML = '';
  const pads = document.getElementById('ritme-pads');

  if (state.ritmeFase === 'intro') {
    pads.style.display = 'none';
    const btn = document.createElement('button');
    btn.className = 'speel-btn';
    btn.textContent = 'â–¶ Hoor het ritme!';
    btn.addEventListener('pointerdown', startDemo);
    actie.appendChild(btn);
  } else if (state.ritmeFase === 'demo') {
    pads.style.display = 'none';
    const div = document.createElement('div');
    div.className = 'status-box status-listen';
    div.textContent = 'ğŸµ Luister goed...';
    actie.appendChild(div);
  } else if (state.ritmeFase === 'spelen') {
    pads.style.display = 'flex';
    renderRitmePads();
    const div = document.createElement('div');
    div.className = 'status-box status-play';
    div.id = 'speel-status';
    div.textContent = 'ğŸ¥ Jij aan de beurt! (0/' + lv.patroon.length + ')';
    actie.appendChild(div);
  } else if (state.ritmeFase === 'resultaat' && state.ritmeScore) {
    pads.style.display = 'flex';
    renderRitmePads();
    const sc = state.ritmeScore;
    const div = document.createElement('div');
    div.className = 'resultaat-box';
    div.style.background = sc.pct===100?'#6BCB7722':sc.pct>=50?'#FFB34722':'#FF6B6B22';
    div.style.border = `1px solid ${sc.pct===100?'#6BCB7744':sc.pct>=50?'#FFB34744':'#FF6B6B44'}`;
    div.innerHTML = `
      <div class="resultaat-emoji">${sc.pct===100?'ğŸ†':sc.pct>=80?'ğŸ‰':sc.pct>=50?'ğŸ‘':'ğŸ’ª'}</div>
      <div class="resultaat-score fredoka">${sc.correct}/${sc.totaal} goed â€“ ${sc.pct}%</div>
      <div class="resultaat-btns">
        <button class="btn-secondary" id="btn-opnieuw">ğŸ”„ Opnieuw</button>
        ${state.ritmeLevelIdx < LEVELS.length-1 && sc.pct >= 70 ? '<button class="btn-primary" id="btn-volgend">Volgend level â†’</button>' : ''}
      </div>
    `;
    actie.appendChild(div);
    document.getElementById('btn-opnieuw').addEventListener('pointerdown', startDemo);
    const bv = document.getElementById('btn-volgend');
    if (bv) bv.addEventListener('pointerdown', () => {
      clearInterval(ritmeTimer);
      state.ritmeLevelIdx++;
      state.ritmeFase = 'intro';
      state.ritmeScore = null;
      state.ritmeInput = [];
      renderRitme();
    });
  }
}

function renderRitmePads() {
  const wrap = document.getElementById('ritme-pads');
  wrap.innerHTML = '';
  DRUMS.forEach(drum => {
    const pad = maakPad(drum, 90, (id) => ritmeSlagHit(id));
    pad.dataset.drumid = drum.id;
    wrap.appendChild(pad);
  });
}

function startDemo() {
  clearInterval(ritmeTimer);
  state.ritmeFase = 'demo';
  state.ritmeInput = [];
  state.ritmeScore = null;
  renderRitmeKaart();

  const lv = LEVELS[state.ritmeLevelIdx];
  const ms = Math.round(60000 / lv.bpm);
  let i = 0;

  setTimeout(() => {
    ritmeTimer = setInterval(() => {
      if (i >= lv.patroon.length) {
        clearInterval(ritmeTimer);
        // Reset alle cellen
        lv.patroon.forEach((_, idx) => {
          const cel = document.getElementById('pc-' + idx);
          if (cel) { cel.classList.remove('demo'); cel.style.transform = ''; }
        });
        setTimeout(() => {
          state.ritmeFase = 'spelen';
          renderRitmeKaart();
        }, 600);
        return;
      }
      const drumId = lv.patroon[i];
      const d = DRUMS.find(x => x.id === drumId);

      // Reset vorige
      if (i > 0) {
        const vorigeCel = document.getElementById('pc-' + (i-1));
        if (vorigeCel) {
          const vd = DRUMS.find(x => x.id === lv.patroon[i-1]);
          vorigeCel.style.background = vd.bg;
          vorigeCel.style.transform = 'scale(1)';
        }
      }
      // Activeer huidige
      const cel = document.getElementById('pc-' + i);
      if (cel) {
        cel.style.background = d.kleur;
        cel.style.transform = 'scale(1.18)';
      }
      playDrum(drumId);
      i++;
    }, ms);
  }, 400);
}

function ritmeSlagHit(drumId) {
  if (state.ritmeFase !== 'spelen') return;
  playDrum(drumId);
  state.ritmeInput.push(drumId);

  const lv = LEVELS[state.ritmeLevelIdx];
  const idx = state.ritmeInput.length - 1;

  // Kleur de cel
  const cel = document.getElementById('pc-' + idx);
  const verwacht = lv.patroon[idx];
  if (cel) {
    cel.style.background = drumId === verwacht ? '#6BCB77' : '#FF6B6B';
    setTimeout(() => {
      const d = DRUMS.find(x => x.id === verwacht);
      if (cel && state.ritmeFase === 'spelen') cel.style.background = d.bg;
    }, 300);
  }

  // Update teller
  const status = document.getElementById('speel-status');
  if (status) status.textContent = 'ğŸ¥ Jij aan de beurt! (' + state.ritmeInput.length + '/' + lv.patroon.length + ')';

  if (state.ritmeInput.length === lv.patroon.length) {
    const correct = state.ritmeInput.filter((d,i) => d === lv.patroon[i]).length;
    const pct = Math.round(correct / lv.patroon.length * 100);
    state.ritmeScore = { correct, totaal: lv.patroon.length, pct };
    state.ritmeFase = 'resultaat';

    if (pct === 100) { schietConfetti(); verdienBadge('perfectie'); }
    voegXPToe(pct >= 80 ? 30 : pct >= 50 ? 15 : 5);

    state.spellenVoltooid++;
    slaOp('drum-spellen', state.spellenVoltooid);
    if (state.spellenVoltooid >= 3) verdienBadge('ritme_held');

    setTimeout(() => renderRitmeKaart(), 200);
  }
}

// â”€â”€ Noten Leren â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderNoten() {
  renderLesTabs();
  renderLesKaart();
}

function renderLesTabs() {
  const wrap = document.getElementById('les-tabs');
  wrap.innerHTML = '';
  LESSEN.forEach((l, i) => {
    const btn = document.createElement('button');
    let cls = 'les-tab';
    if (state.notenGeleerd.includes(l.id)) cls += ' geleerd';
    else if (i === state.lesIdx) cls += ' actief';
    btn.className = cls;
    btn.textContent = state.notenGeleerd.includes(l.id) ? 'âœ“' : l.id;
    btn.addEventListener('pointerdown', () => {
      state.lesIdx = i;
      state.lesKlaar = false;
      renderNoten();
    });
    wrap.appendChild(btn);
  });
}

function renderLesKaart() {
  const les = LESSEN[state.lesIdx];
  const kaart = document.getElementById('les-kaart');
  kaart.innerHTML = '';

  // Titel
  const h3 = document.createElement('h3');
  h3.className = 'fredoka';
  h3.style.fontSize = '20px';
  h3.style.marginBottom = '10px';
  h3.textContent = les.titel;
  kaart.appendChild(h3);

  // Uitleg
  const p = document.createElement('p');
  p.className = 'les-uitleg';
  p.textContent = les.uitleg;
  kaart.appendChild(p);

  // Noten visualisatie
  const notenDiv = document.createElement('div');
  notenDiv.className = 'noten-grid';
  notenDiv.innerHTML = '<div class="noten-label">ğŸ“ NOTEN VOORBEELD:</div>';
  const rij = document.createElement('div');
  rij.className = 'noten-row';
  les.symbolen.forEach((s, i) => {
    const kleur = les.kleuren[i];
    const isDim = kleur === '#ddd';
    const cel = document.createElement('div');
    cel.className = 'noot-cel';
    cel.innerHTML = `
      <div class="noot-blok" style="background:${isDim?'#ffffff11':kleur};color:${isDim?'#ffffff33':'#fff'};border:2px solid ${isDim?'#ffffff15':kleur};box-shadow:${isDim?'none':'0 3px 12px '+kleur+'55'}">${s}</div>
      <span class="noot-num">${i+1}</span>
    `;
    rij.appendChild(cel);
  });
  notenDiv.appendChild(rij);
  kaart.appendChild(notenDiv);

  // Tip
  const tipDiv = document.createElement('div');
  tipDiv.className = 'tip-oefening';
  tipDiv.innerHTML = `<div class="tip-oef-label">ğŸ’¡ ZONDER SCHERM OEFENEN:</div><div class="tip-oef-tekst">${les.oefening}</div>`;
  kaart.appendChild(tipDiv);

  // Geluid knop
  if (les.drum) {
    const d = DRUMS.find(x => x.id === les.drum);
    const geluidDiv = document.createElement('div');
    geluidDiv.style.marginBottom = '14px';
    geluidDiv.innerHTML = '<div class="geluid-label">ğŸ§ HOOR HET GELUID:</div>';
    const pad = maakPad(d, 80, (id) => { playDrum(id); });
    geluidDiv.appendChild(pad);
    kaart.appendChild(geluidDiv);
  }

  // Voltooi knop
  const voltooiBtn = document.createElement('button');
  voltooiBtn.className = 'btn-voltooi';
  voltooiBtn.style.background = state.notenGeleerd.includes(les.id)
    ? '#4ECDC4' : 'linear-gradient(135deg,#45B7D1,#4ECDC4)';
  voltooiBtn.textContent = state.notenGeleerd.includes(les.id) ? 'âœ“ Les voltooid!' : 'âœ“ Ik snap het!';
  voltooiBtn.addEventListener('pointerdown', () => {
    if (!state.notenGeleerd.includes(les.id)) {
      state.notenGeleerd.push(les.id);
      slaOp('drum-noten', JSON.stringify(state.notenGeleerd));
      voegXPToe(20);
      if (state.notenGeleerd.length >= 5) verdienBadge('noot_meester');
    }
    state.lesKlaar = true;
    renderNoten();
  });
  kaart.appendChild(voltooiBtn);

  // Volgende les knop
  if (state.lesKlaar && state.lesIdx < LESSEN.length - 1) {
    const volgendeBtn = document.createElement('button');
    volgendeBtn.className = 'btn-red';
    volgendeBtn.textContent = 'Volgende les â†’';
    volgendeBtn.addEventListener('pointerdown', () => {
      state.lesIdx++;
      state.lesKlaar = false;
      renderNoten();
    });
    kaart.appendChild(volgendeBtn);
  }
}

// â”€â”€ Badges â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderBadges() {
  const grid = document.getElementById('badges-grid');
  grid.innerHTML = '';
  BADGES.forEach(b => {
    const div = document.createElement('div');
    div.className = 'badge-card' + (state.badges.includes(b.id) ? ' verdiend' : '');
    div.innerHTML = `
      <div class="badge-emoji">${b.emoji}</div>
      <div class="badge-naam">${b.naam}</div>
      <div class="badge-eis">${b.eis}</div>
    `;
    grid.appendChild(div);
  });
}

// â”€â”€ Print â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openPrint() {
  const modal = document.createElement('div');
  modal.style.cssText = 'position:fixed;inset:0;background:#000a;z-index:1000;display:flex;align-items:center;justify-content:center;padding:16px;';
  modal.innerHTML = `
    <div style="background:#fff;border-radius:20px;padding:24px;max-width:520px;width:100%;max-height:88vh;overflow-y:auto;font-family:'Nunito',sans-serif;color:#333;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h2 style="margin:0;font-size:20px;">ğŸ–¨ï¸ Oefenkaarten â€“ zonder scherm!</h2>
        <button onclick="this.closest('div[style]').remove()" style="background:none;border:none;font-size:22px;cursor:pointer;color:#333;">âœ•</button>
      </div>
      <div style="border:3px dashed #FF6B6B;border-radius:14px;padding:14px;margin-bottom:12px;">
        <div style="font-weight:900;font-size:15px;color:#FF6B6B;margin-bottom:8px;">ğŸ¥ KAART 1 â€“ De 4 Slagen</div>
        <p style="margin:0 0 8px;color:#555;font-size:13px;">Tel hardop: <strong>1 â€“ 2 â€“ 3 â€“ 4</strong> en klap op elke tel!</p>
        <div style="display:flex;gap:8px;">${['1','2','3','4'].map((n,i)=>`<div style="flex:1;height:40px;background:${['#FF6B6B','#FFB347','#4ECDC4','#45B7D1'][i]};border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900;font-size:20px;">${n}</div>`).join('')}</div>
        <p style="margin:8px 0 0;color:#888;font-size:12px;">ğŸ’¡ Doe dit 10x mee op muziek!</p>
      </div>
      <div style="border:3px dashed #96CEB4;border-radius:14px;padding:14px;margin-bottom:12px;">
        <div style="font-weight:900;font-size:15px;color:#2d7a4f;margin-bottom:8px;">ğŸ’£ KAART 2 â€“ Kick Ritme</div>
        <p style="margin:0 0 8px;color:#555;font-size:13px;">Stamp met je voet op <strong>slag 1 en 3</strong>:</p>
        <div style="font-family:monospace;font-size:18px;letter-spacing:4px;color:#333;"><span style="color:#96CEB4;font-weight:900;">BOEM</span> â€“ â€“ â€“ <span style="color:#96CEB4;font-weight:900;">BOEM</span> â€“ â€“ â€“</div>
        <p style="margin:8px 0 0;color:#888;font-size:12px;">ğŸ’¡ Eerst langzaam, dan steeds sneller!</p>
      </div>
      <div style="border:3px dashed #45B7D1;border-radius:14px;padding:14px;margin-bottom:12px;">
        <div style="font-weight:900;font-size:15px;color:#45B7D1;margin-bottom:8px;">âš¡ KAART 3 â€“ Snare Backbeat</div>
        <p style="margin:0 0 8px;color:#555;font-size:13px;">Klap op je knie op <strong>slag 2 en 4</strong>:</p>
        <div style="font-family:monospace;font-size:18px;letter-spacing:4px;color:#333;">â€“ â€“ â€“ <span style="color:#45B7D1;font-weight:900;">PAK</span> â€“ â€“ â€“ <span style="color:#45B7D1;font-weight:900;">PAK</span></div>
        <p style="margin:8px 0 0;color:#888;font-size:12px;">ğŸ’¡ Snap je vingers of klap in je handen!</p>
      </div>
      <div style="border:3px dashed #FFB347;border-radius:14px;padding:14px;margin-bottom:12px;">
        <div style="font-weight:900;font-size:15px;color:#E6820A;margin-bottom:8px;">ğŸ© KAART 4 â€“ Hi-Hat Trein</div>
        <p style="margin:0 0 8px;color:#555;font-size:13px;">Tik op tafel op <strong>elke tel</strong>:</p>
        <div style="font-family:monospace;font-size:15px;color:#FFB347;font-weight:900;letter-spacing:3px;">tss â€“ tss â€“ tss â€“ tss â€“ tss â€“ tss â€“ tss â€“ tss</div>
        <p style="margin:8px 0 0;color:#888;font-size:12px;">ğŸ’¡ Net als een trein: gelijkmatig!</p>
      </div>
      <div style="border:3px solid #FF6B6B;border-radius:14px;padding:14px;background:#fff8f8;margin-bottom:16px;">
        <div style="font-weight:900;font-size:15px;color:#FF6B6B;margin-bottom:8px;">ğŸ¶ KAART 5 â€“ Het Basisritme!</div>
        <p style="margin:0 0 8px;color:#555;font-size:13px;">Alles samen (voet=kick, knie=snare, vinger=hi-hat):</p>
        <div style="display:grid;grid-template-columns:repeat(8,1fr);gap:4px;">${['ğŸ’£','ğŸ©','â€”','ğŸ©','âš¡','ğŸ©','â€”','ğŸ©'].map(s=>`<div style="height:36px;background:${s==='â€”'?'#f0f0f0':'#fff3e0'};border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:13px;border:1.5px solid ${s==='â€”'?'#e0e0e0':'#FFB347'}">${s}</div>`).join('')}</div>
        <p style="margin:8px 0 0;color:#888;font-size:12px;">ğŸ’¡ <strong>BOEM</strong>-tss-<strong>PAK</strong>-tss â€“ herhaal!</p>
      </div>
      <button onclick="window.print()" style="width:100%;padding:13px;border-radius:12px;background:#FF6B6B;color:#fff;border:none;cursor:pointer;font-weight:900;font-size:15px;font-family:'Fredoka One',sans-serif;">ğŸ–¨ï¸ Printen!</button>
    </div>
  `;
  modal.addEventListener('pointerdown', e => { if (e.target === modal) modal.remove(); });
  document.body.appendChild(modal);
}

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
laad();
updateHeader();
updateHero();
updateBadgesSub();
document.getElementById('tip-tekst').textContent = TIPS[new Date().getDay()];
</script>
</body>
</html>
